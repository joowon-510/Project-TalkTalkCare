## 📌1월 17일 금요일

- ERD 설계

```bash
- 유저 테이블
    - uid → pk
    - id → 아이디 or 카카오 이메일
    - password
    - name
    - birth
    - phone
    - logined_at
- 카카오 유저 테이블
    - id → autoIncre pk
    - uid fk
    - oauth_id
    - access_token
    - refresh_token
    - 외래키 cascade
- 보안 테이블
    - uid pk,fk
    - random salt 
- 친구 테이블
    - id pk
    - uid (본인) fk
    - fid (친구)  fk
    - status (enum)
- 게임 카테고리별 테이블
    - uid pk fk
    - average (double)
    - category (enum)
- 게임 기록 일 별 테이블(해당 월 -30/31일)  → 배치
    - id pk
    - uid fk
    - game_category (enum, ?)
    - score (int)
    - played_at (datetime)
- 게임 결과테이블(1월 - 30점, 2월 - 40점)  → 배치
    - **한 달이 지날 때마다 게임 기록 일 별 테이블을 가져와 해당 월의 평균을 갖고 와서 계산 후 삽입**
    - id pk
    - uid fk
    - date(%Y-%M)
    - score(double)
- 말동무테이블
    - uid pk,fk
    - last_conversation_summary (textarea)
- 사용자 치매진단테이블
    - uid pk,fk
    - user_answer_smcq - json {1 : 1, 2: 1 , ,,,, 14: 0}
    - user_prev_smcq -  json {1 : 1, 2: 1 , ,,,, 14: 0}
    - protector_answer_sdq - json{1 : 1, 2: 0 , ,,,,  32: 1}
    - user_date
    - protector_date
```

## 📌1월 16일 목요일

### Kurento

- 전체 WebRTC 스택의 기능적 구현을 제공하는 미디어 서버
- Http, RTP, WebRTC 을 포함한 네트워크 스트리밍 프로토콜 등 다양한 기능 지원

### openVidu

- Kurento에 기반한 웹 또는 모바일 어플리케이션에서 화상 통화를 쉽게 추가할 수 있는 플랫폼
- OpenVidu Browser : 클라이언트 측에서 사용할 라이브러리
- OpenVidu Server : 서버 측 내용 처리하는 어플리케이션

### 오늘 한 일

<aside>
💡

치매진단테스트 기능의 요구사항 분석 및 정의서 작성

</aside>

| 요구사항ID | 요구사항명 | 요구사항 설명 | 상세 기 |
| --- | --- | --- | --- |
| REQ-501 | 비로그인 사용자 SMCQ 테스트 수행 | 비로그인 사용자가 치매진단테스트(SMCQ)를 수행 | -비로그인 사용자가 테스트페이지 접근 시 본인이 수행하는 치매진단테스트(SMCQ)만 선택 가능하도록 설정-14개 질문에 대한 선택형 입력 제공-점수를 계산하여 결과 화면에 표시-메인페이지 + 치매진단 파업 |
| REQ-502 | 비로그인 사용자 테스트 결과 임시 저장  | 비로그인 사용자의 치매진단테스트 결과를 임시 저장 | -비로그인 사용자가 SMCQ를 수행하면 결과 데이터를 브라우저(로컬 스토리지 등)에 저장-저장 데이터는 사용자가 체크한 항목, 점수, 테스트 시간 등을 포함-만료시간을 설정하여 1시간 후 데이터 삭제 |
| REQ-503 | 로그인 후 데이터 저장 | 비로그인 상태에서 저장된 테스트 데이터를 로그인 후 사용자 계정과 연결하여 데이터베이스에 저장 | -사용자가 회원가입 후 로그인을 하면 브라우저에서 테스트 데이터 조회-조회된 데이터를 데이터베이스에 저장하여 사용자 계정과 매핑-저장 완료되면 브라우저에서 데이터 삭제 |
| REQ-504 | 로그인 사용자 SMCQ 테스트 수행 | 로그인 사용자가 치매진단테스트(SMCQ)를 수행 | -로그인 상태 확인 후 테스트 페이지에서 SMCQ 선택-14개 질문에 대한 선택형 입력 제공-사용자의 답변 데이터를 기반으로 점수 계산-계산된 점수 표시 |
| REQ-505 | 로그인 사용자 SMCQ 테스트 저장 | 로그인 사용자의 SMCQ 수행 결과를 데이터베이스에 저장 | -점수 계산 후 데이터베이스에 저장 -저장 시 사용자 계정과 테스트 결과 매핑 |
| REQ-506 | 로그인 사용자 SDQ 테스트 수행 | 로그인 사용자의 보호자로서 SDQ를 수행하며 결과 저장 | -로그인 상태 확인 후 테스트 페이지에서 SDQ 선택-32개 질문에 대한 선택형 입력 제공-사용자의 답변 데이터를 기반으로 점수 계산-계산된 점수 표시 |
| REQ-507 | 로그인 사용자 SDQ 테스트 저장 | 로그인 사용자의 SDQ 수행 결과를 데이터베이스에 저장 | -점수 계산 후 데이터베이스에 저장 -저장 시 사용자 계정과 테스트 결과 매핑 |
| REQ-508 | 결과 비교 및 AI 분석 | 로그인 사용자가 수행한 SMCQ 및 SDQ 결과를 저장하여 AI 를 통한 결과 분석 | -사용자 ID를 기반으로 SMCQ와 SDQ 결과 조회-AI를 활용하여 SMCQ-SDQ 간 차이점 맟 바로 전 테스트와 현재 테스트 결과에 따른 변화 분석-분석 결과를 요약하여 텍스트로 제공 |

## 📌1월 15일 수요일

### SDP

- SDP
    - Session Description Protocol
    - webRTC에서 스트리밍 미디어의 해상도나 형식, 코덱 등의 멀티미디어 컨텐츠의 초기 인수를 설명하기 위해 채택한 프로토콜
    - 웹캠 비디오의 해상도를 보낼 수 있고, 오디오 전송 또는 송신 여부를 보낼 수도 있음

### Trickle ICE

- Trickle ICE
    - 일반적으로 각 피어는 ICE후보들을 수집해서 그 목록을 완성한 후 한꺼번에 교환하게 됩니다
        - 후보를 모으는데 시간이 오래 걸리고, 그 과정에서 네트워크 환경에 따라 지연이 발생할 수 있다
    - 이러한 비효율적인 후보 교환을 병렬 프로세스로 수행할 수 있게 만드는 것
    - 두 개의 피어가 ICE 후보를 수집하고 교환하는 과정
    - 동기적 프로세스에서 비동기적 프로세스로 만드는 기술

### Signaling

- RTCPeerConnection 통신에 사용한 프로토콜, 채널, 미디어 코덱 및 형식, 데이터 전송 방법 등을 포함한 통신 규격을 교환하기 위해 두 장치의 제어 정보를 교환하는 과정
- WebRTC 연결 전 미리 준비해야 하는 과정
- 방법
    - 시그널링 서버를 직접 구축
        - 웹 소켓이나 서버 전송 이벤트 방법을 적용
    - 시그널링 서버를 제공해주는 외부 솔루션 적용

## 📌1월 14일 화요일

### STUN, TURN

- **STUN**
    - 단말이 자신의 공인 IP주소와 포트를 확인하는 과정에 대한 프로토콜
    - 인터넷의 복잡한 주소들 속에서 유일하게 자신을 식별할 수 있는 정보를 반환
    - WebRTC 연결을 시작하기 전에 STUN 서버를 향해 요청을 보내면, STUN 서버는 NAT 뒤에 있는 Peer들이 서로 연결할 수 있도록 공인 IP와 포트를 찾아줍니다
    - 어떤 라우터들은 방화벽 정책을 달리 할 수도 있고, 이전에 연결된 적이 있는 네트워크만 연결할 수 있게 제한을 걸기도 합니다
    - 자기 자신의 주소를 찾아내지 못했을 경우, **TURN 서버**를 대안으로 이용하게 됩니다
- TURN
    - 네트워크 미디어를 중개하는 서버
    - TURN 방식은 중간에 서버를 한 번 거치기 때문에, P2P 통신이 아니게 되며 구조상 지연이 발생
    - 보안 정책이 엄격한 개인 NAT 내부에 위치한 브라우저와 P2P 통신을 할 수 있는 유일한 방법이기 때문에, TURN 방식은 최후의 수단으로 선택되어야 함

### ICE 와 Candidate

- 후보
    - STUN, TURN 서버를 이용해서 획득했던 IP주소와 프로토콜, 포트의 조합으로 구성된 연결 가능한 네트워크 주소
    - 후보 수집시 일반적으로 3개의 주소를 얻게 된다
        - 자신의 사설IP와 포트 넘버
        - 자신의 공인IP와 포트 넘버 (STUN, TURN 서버로부터 획득 가능)
        - TURN서버의 IP와 포트 넘버 (TURN 서버로부터 획득 가능)
- ICE
    - 두 개의 단말이 P2P 연결을 가능하게 하도록 최적의 경로르 찾아주는 프레임워크
    - ICE 프레임워크가 STUN, 또는 TURN 서버를 이용해 상대방과 연결 가능한 후보들을 갖고 있다
    - 두 브라우저가 P2P통신을 위해 통신할 수 있는 주소만큼은 확실하게 알아냈다

## 📌1월 13일 월요일

### WebRTC 란?

- Web Real-Time Communication
- 웹/앱에서 별다른 소프트웨어 없이 카메라, 마이크 등을 사용하여 실시간 커뮤니테이션을 제공해주는 기술
- 화상 통화, 화상 공유 등을 구현할 수 있는 오픈 소스
- 비디오, 음성 등 일반 데이터가 P2P 방식으로 피어간의 전송되도록 지원
- 중개 서버를 거치지 않고 브라우저간을 P2P로 연결하는 기술

### P2P 절차

- 각 브라우저가 P2P 통신에 동의
- 서로의 주소를 공유
- 보안 사항 및 방화벽 우회
- 멀티미디어 데이터를 실시간으로 교

### 장점

- Latency가 짧다
- 별다른 소프트웨어 없이 실시간 커뮤니케이션이 가능하다
- 진입 장벽이 낮아
- 무료

### 단점

- STUN/ TURN 서버가 필요하다
    - P2P통신을 하기 위해 사용자의 IP주소를 알아야한다
    - 대부분 사용자들은 방화벽을 사용하기 때문에 네트워크 상 연결을 위해 STUN/TURN서버가 필요하다

### Data Stream

- connection-oriented 통신에서 연속적으로 흘러나오는 데이터들의 흐름
- 데이터의 양이 한정되어 있지 않고 끊임없이 생성되고 변하는 데이터들의 흐름

### NAT

- Network Address Translation
- 네트워크 주소 변환

### Signaling

- P2P통신이 일어나기 전에 세션 제어 메세지, 네트워크 구성, 미디어 기능 등의 정보를 교환하는데 사용
- 세션 제어 메세지 : 통신을 초기화하거나 닫고 오류를 보고
- 네트워크 구성 : 외부 세계에 컴퓨터의 IP주소와 포트는 무엇인지 파악
- 미디어 기능 : 브라우저와 통신하려는 브라우저에서 처리할 수 있는 코덱과 해상도는 무엇인지 파악
